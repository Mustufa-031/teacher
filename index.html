<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Legacy | Tribute Collection</title>
    
    <!-- Premium Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;600&family=Noto+Nastaliq+Urdu:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <!-- HTML2PDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* --- THEME & VARIABLES --- */
        :root {
            --bg-deep: #050505;
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #000000 100%);
            --gold: #C5A028;
            --gold-glow: rgba(197, 160, 40, 0.4);
            --gold-dim: #8a6e1c;
            --card-bg: #fffdf7; /* Antique White */
            --text-main: #1a1a1a;
            --text-muted: #555;
            
            --font-urdu: 'Noto Nastaliq Urdu', serif;
            --font-title: 'Cinzel', serif;
            --font-display: 'Playfair Display', serif;
            --font-body: 'Inter', sans-serif;
            --font-poetic: 'Amiri', serif;
        }

        /* --- RESET --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-body);
            background: var(--bg-deep);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden; 
        }

        /* --- CANVAS BACKGROUND --- */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* --- LAYOUT WRAPPER --- */
        .wrapper {
            position: relative;
            z-index: 10;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            margin-top: 4rem;
            animation: fadeInDown 1.2s ease-out;
        }

        h1 {
            font-family: var(--font-title);
            font-size: 3.5rem;
            background: linear-gradient(to right, #fff, var(--gold), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        p.subtitle {
            font-family: var(--font-display);
            font-style: italic;
            color: rgba(255,255,255,0.7);
            font-size: 1.2rem;
            letter-spacing: 1px;
        }

        /* --- SEARCH SECTION --- */
        .search-container {
            margin-top: 4rem;
            width: 100%;
            max-width: 500px;
            position: relative;
            text-align: center;
        }

        .input-group {
            position: relative;
        }

        input {
            width: 100%;
            padding: 20px 10px;
            background: transparent;
            border: none;
            border-bottom: 2px solid rgba(255,255,255,0.2);
            font-family: var(--font-display);
            font-size: 1.5rem;
            color: white;
            text-align: center;
            transition: all 0.3s ease;
        }

        input:focus {
            outline: none;
            border-bottom-color: var(--gold);
        }

        input::placeholder { color: rgba(255,255,255,0.2); }

        .btn-generate {
            margin-top: 3rem;
            background: transparent;
            color: var(--gold);
            border: 1px solid var(--gold);
            padding: 15px 50px;
            font-family: var(--font-title);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-generate::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: var(--gold);
            transition: left 0.4s ease;
            z-index: -1;
        }

        .btn-generate:hover {
            color: #000;
        }
        .btn-generate:hover::before {
            left: 0;
        }

        /* --- BUTTON ANIMATION (PLAY EFFECT) --- */
        @keyframes playClick {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(0.95) rotate(-3deg) translateX(-3px); }
            50% { transform: scale(1.05) rotate(3deg) translateX(3px); }
            75% { transform: scale(0.95) rotate(-2deg) translateX(-2px); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .playing-btn {
            animation: playClick 0.5s ease;
        }

        /* --- MODAL OVERLAY --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.92);
            backdrop-filter: blur(15px);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        /* --- TRIBUTE CARD DESIGN --- */
        .card-scroller {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            overflow-y: auto;
            padding: 20px;
        }

        .card-scroller::-webkit-scrollbar { width: 8px; }
        .card-scroller::-webkit-scrollbar-thumb { background: var(--gold-dim); border-radius: 4px; }
        .card-scroller::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }

        .card {
            background: var(--card-bg);
            color: var(--text-main);
            padding: 4rem;
            position: relative;
            box-shadow: 0 30px 80px rgba(0,0,0,0.6);
            transform: perspective(1000px) rotateX(5deg) translateY(50px);
            opacity: 0;
            transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            border: 10px solid white;
            outline: 1px solid var(--gold);
            /* Important for PDF background */
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .modal-overlay.active .card {
            transform: perspective(1000px) rotateX(0deg) translateY(0px);
            opacity: 1;
        }

        /* --- CARD DECORATIONS --- */
        .card::before {
            content: '';
            position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border: 1px solid #ddd;
            pointer-events: none;
        }

        .corner-decor {
            position: absolute;
            width: 40px; height: 40px;
            border-top: 3px solid var(--gold);
            border-right: 3px solid var(--gold);
            top: 20px; right: 20px;
        }
        .corner-decor.bottom-left {
            top: auto; right: auto;
            bottom: 20px; left: 20px;
            transform: rotate(180deg);
        }

        /* --- TYPOGRAPHY IN CARD --- */
        .teacher-name {
            font-family: var(--font-display);
            font-size: 4rem;
            text-align: center;
            color: var(--text-main);
            margin-bottom: 0.5rem;
            line-height: 1;
            opacity: 0;
            animation: fadeIn 1s ease forwards 0.2s;
        }

        .teacher-title {
            font-family: var(--font-poetic);
            font-style: italic;
            text-align: center;
            font-size: 1.3rem;
            color: var(--gold-dim);
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeIn 1s ease forwards 0.4s;
        }

        .urdu-box {
            background: #fcfaf2;
            border: 2px solid var(--gold-dim);
            padding: 3rem 2rem;
            margin-bottom: 3rem;
            border-radius: 4px;
            position: relative;
            opacity: 0;
            animation: slideUp 0.8s ease forwards 0.6s;
        }
        
        .urdu-box::after {
            content: '♥';
            position: absolute;
            top: 50%; left: 10px;
            transform: translateY(-50%);
            color: rgba(197, 160, 40, 0.2);
            font-size: 4rem;
        }

        .urdu-text {
            font-family: var(--font-urdu);
            font-size: 1.8rem;
            line-height: 2.5;
            text-align: center;
            direction: rtl;
            color: #000;
        }

        .section-header {
            font-family: var(--font-title);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #999;
            margin-bottom: 1.5rem;
            text-align: center;
            opacity: 0;
            animation: fadeIn 1s ease forwards 0.8s;
        }

        .qualities-list {
            list-style: none;
            text-align: center;
            font-family: var(--font-poetic);
            font-size: 1.3rem;
            color: #444;
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeIn 1s ease forwards 1s;
        }

        .appreciation {
            font-size: 1.1rem;
            line-height: 1.9;
            color: #333;
            text-align: justify;
            text-align-last: center;
            opacity: 0;
            animation: fadeIn 1s ease forwards 1.2s;
        }

        /* --- ACTIONS --- */
        .actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 3rem;
            opacity: 0;
            animation: fadeIn 1s ease forwards 1.4s;
        }

        .btn-action {
            padding: 12px 30px;
            background: var(--gold);
            color: #000;
            border: none;
            font-family: var(--font-title);
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }
        .btn-action:hover { transform: translateY(-2px); }
        .btn-secondary {
            background: white;
            color: #000;
        }

        .close-modal {
            position: fixed;
            top: 30px;
            right: 30px;
            background: transparent;
            border: none;
            color: white;
            font-size: 3rem;
            cursor: pointer;
            z-index: 101;
            transition: transform 0.3s;
        }
        .close-modal:hover { transform: rotate(90deg); color: var(--gold); }

        /* --- KEYFRAMES --- */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- PRINT & PDF OVERRIDES --- */
        @media print {
            body { background: white; display: block; overflow: visible; }
            #bg-canvas, .wrapper, .close-modal, .actions { display: none !important; }
            .modal-overlay { 
                position: static; 
                background: white; 
                opacity: 1; 
                display: block;
                padding: 0;
            }
            .card-scroller { height: auto; max-width: 100%; overflow: visible; }
            .card { 
                box-shadow: none; 
                border: 1px solid #ddd;
                padding: 2cm;
                transform: none !important;
                opacity: 1 !important;
                margin: 0 auto;
            }
            .corner-decor { display: none; }
            .teacher-name, .teacher-title, .urdu-box, .section-header, .qualities-list, .appreciation, .actions {
                animation: none !important;
                opacity: 1 !important;
            }
        }

        /* --- MOBILE --- */
        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .card { padding: 2rem; }
            .teacher-name { font-size: 2.5rem; }
            .urdu-text { font-size: 1.3rem; }
            .card-scroller { padding: 10px; }
            .close-modal { top: 20px; right: 20px; font-size: 2rem; }
        }
    </style>
</head>
<body>

    <!-- Dynamic Background -->
    <canvas id="bg-canvas"></canvas>

    <div class="wrapper">
        <header>
            <h1>The Legacy</h1>
            <p class="subtitle">A Tribute to Our Guiding Lights</p>
        </header>

        <div class="search-container">
            <div class="input-group">
                <input type="text" id="teacherInput" placeholder="Type your Name" autocomplete="off">
            </div>
            <button class="btn-generate" id="btnGen" onclick="findTribute()">Reveal Tribute</button>
            <div id="error-msg" style="color: var(--gold); margin-top: 20px; display: none; font-family: var(--font-poetic);">Name not found in our records.</div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
        <button class="close-modal" onclick="closeCard()">&times;</button>
        <div class="card-scroller">
            <div class="card" id="card-content">
                <div class="corner-decor"></div>
                <div class="corner-decor bottom-left"></div>
                
                <!-- Content Injected Here -->
            </div>

            <div class="actions">
                <button class="btn-action" id="btnDownload" onclick="downloadPDF()">Download PDF</button>
                <button class="btn-action btn-secondary" onclick="closeCard()">Close</button>
            </div>
        </div>
    </div>

    <script>
        /* --- 1. GOLD DUST PARTICLE BACKGROUND --- */
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2 + 0.5;
                this.speedX = Math.random() * 0.5 - 0.25;
                this.speedY = Math.random() * 0.5 - 0.25;
                this.opacity = Math.random() * 0.5 + 0.1;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.size > 0.2) this.size -= 0.005;
                if (this.size <= 0.2 || this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 0.5;
                }
            }
            draw() {
                ctx.fillStyle = `rgba(197, 160, 40, ${this.opacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initParticles() {
            for (let i = 0; i < 100; i++) particles.push(new Particle());
        }
        
        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animateParticles);
        }
        initParticles();
        animateParticles();


        /* --- 2. DATA & LOGIC --- */
        const teacherData = {
            "shahnila": {
                name: "Miss Shahnila",
                title: "صولتِ صوت و شفقتِ دل – *Majesty of Voice & Kindness of Heart*",
                sher: `ہر سُر میں ہے تاثیر، رواں ہے فاصِلوں پر تیری\nجوشِ رُوح رُباب، ہمت کو ہے آفتاب تیری\n\nگو خواص ہے ترا اندازِ دَشت\nکرے اظہار گوش و جبر، تب بھی باتوں سے پھول جھرتے ہیں`,
                qualities: ["Strong, commanding voice yet deeply loving", "Inspires courage and warmth simultaneously", "Balance of authority and empathy"],
                appreciation: "Your energy forged our resilience. We will miss the loud voice that commanded respect and the tireless heart that always pushed us to do better."
            },
            "sidra": {
                name: "Miss Sidra",
                title: "The Gem of a Teacher",
                sher: `ہے منتشرِ تُراب، ذرّۂ گلاب، صِنعتِ اُستاد\nہر حرف با نور، ہر اصول خود ایک اِرشاد\n\nمسکان میں ہے کمال، گویا ظہورِ آفتاب\nسیرت یوں بے مثال، گویا بنی ضربُ المثال`,
                qualities: ["Unique, radiant personality", "Exemplary character and integrity", "Knowledgeable and inspiring"],
                appreciation: "You taught us that balance is the key to wisdom. Thank you for being the calm, guiding light in the chaos of our school days."
            },
            "sarwat": {
                name: "Miss Sarwat",
                title: "ہمرازِ احساس – *Confidante of Emotions*",
                sher: `کلام میں شگفتگی، دل میں وُسعت بے مثال\nہو اظہارِ درد، اظہارِ غم، ہر وصل میں ساتھ\n\nہے نقشِ باکمال، ہے سخنِ آسمان بھی تفصیل تیری\nہے بیاں میں بصیرت، ہر لفظ میں وقار تیرا`,
                qualities: ["Deeply empathetic and understanding", "Inspires emotional intelligence", "Wisdom combined with clarity and elegance"],
                appreciation: "Thank you for being the safe harbor in our storms. For listening when we needed to be heard and for solving our problems with a patience that we will never forget."
            },
            "fouzia": {
                name: "Miss Fouzia",
                title: "مخفیِ قلبِ جوہر – *Hidden Gem of Heart*",
                sher: `یہ نگاہ کا کمال ہے کہ وصف بے مثال ہے\nنظر میں حیاتِ اُستاد، دل میں ہوک سی اُتار ہے\n\nفقط روش، طرزِ حال سخت گو\nمنفرد ہے مزاج، پنہاں قلب میں لطیف گُداز`,
                qualities: ["Outer strictness, inner softness", "Unique temperament", "Deeply caring and subtly influential"],
                appreciation: "We learned that true strength protects what is soft. Thank you for showing us that beneath the strict discipline lies a heart that cares deeply for our success."
            },
            "asma naseem": {
                name: "Miss Asma Naseem",
                title: "Heart of School",
                sher: `گل ساز ہو تم، علم ساز ہو تم، بہارِ دل کی مہک ہو تم\nکیا کہوں صفت میں کہ بے مثلِ گلاب ہو تم\n\nہر سبق ہے جلوہ تری شمع کا\nتو جو ہے تو ہے آسمان بھی روشن، ہر نجمِ تاباں بھی روشن`,
                qualities: ["Central guiding presence of school", "Inspires love for learning", "Warmth and illumination in teaching"],
                appreciation: "Your grace is the lesson we will carry forever. Thank you for nurturing not just our minds, but our spirits, with such quiet dignity."
            },
            "iqra": {
                name: "Miss Iqra",
                title: "اجرک کی خوشبو – *Fragrance of Ajrak*",
                sher: `سندھی دل ہو تم ہی، اجرک ساز بھی تم ہی\nراست گو ہو تم ہی، ہُدیٰ نواز بھی تم\n\nسندھ جی رانی آہیں، حُسن جی مثال ہو تم\nبے مثال ہو تم ہی، شکلِ لُباب بھی تم`,
                qualities: ["Proudly Sindhi, cultural identity reflected in personality", "Honest, straightforward, and nurturing", "Playful yet inspiring"],
                appreciation: "You connected us to our roots while pointing us to our future. Thank you for keeping our culture alive in your words and teaching us to look ahead with pride."
            },
            "aliya": {
                name: "Miss Aliya",
                title: "Our Second Parent",
                sher: `ہر دل پر ہے کنار بھی تیرا، کیا کہوں کہ نرم خو انداز ہے تیرا\nاثر یوں لازوال کہ حدِ نگاہ تک دراز ہے تیرا\n\nہے خیال اس قدر کہ ہر دل میں مقام ہے تیرا\nکیا پکاروں تجھ کو، کہ اصنافِ لقب ماں ہے تیرا`,
                qualities: ["Nurturing, protective, and caring", "Warmth and guidance akin to parental figure", "Leaves lasting impression on students"],
                appreciation: "You made school feel like home. Thank you for the warmth, the shared memories, and the affectionate guidance that made us feel so safe."
            },
            "nighat": {
                name: "Miss Nighat",
                title: "چراغِ صداقت – *Lamp of Truth*",
                sher: `جن کے کردار سے آتی ہو صداقت کی مہک\nاُن کی تدریس سے تو پتھر بھی پگھل جاتے ہیں\n\nسنا ہے اُن کی ہستی سے روشن زمانے ہوتے ہیں\nاندھیروں میں چراغ جلانے کے بھی بہانے ہوتے ہیں`,
                qualities: ["Moral integrity, honesty, and truthfulness", "Guides students ethically and intellectually", "Brings light to dark situations, inspiring hope"],
                appreciation: "Your presence commanded respect, and your lessons have shaped who we are today. Thank you for being the unshakeable pillar we could always lean on."
            },
            "anila": {
                name: "Miss Anila",
                title: "شوخ فہم – *Playful Wit / Clever Humor*",
                sher: `شُجُع تم کو کہہ دوں، مگر انداز ذرا فہم ہے\nمیں ترے قہقہے پر ہنس تو دوں، مگر مذاق ذرا بے دَم ہے\n\nعکس ہو قمر کا، سرمایۂ نور ہو تم\nسنا ہے اردو کے اُستاد ہو تم`,
                qualities: ["Bold, witty, and playful", "Inspires laughter while maintaining dignity", "Fun and approachable, yet respected"],
                appreciation: "You made us brave enough to laugh and learn. Thank you for the high energy and the courage to be yourself, which inspired us to be confident in who we are."
            }
        };

        /* --- 3. UI LOGIC --- */
        const input = document.getElementById('teacherInput');
        const errorMsg = document.getElementById('error-msg');
        const modal = document.getElementById('modal');
        const cardContent = document.getElementById('card-content');
        const btnGen = document.getElementById('btnGen');
        const btnDownload = document.getElementById('btnDownload');

        function playAnimation(element) {
            element.classList.remove('playing-btn');
            void element.offsetWidth; // trigger reflow
            element.classList.add('playing-btn');
        }

        function findTribute() {
            playAnimation(btnGen);
            const raw = input.value.trim();
            if(!raw) return;
            const key = raw.toLowerCase().replace("miss", "").trim();

            if(teacherData[key]) {
                setTimeout(() => { // Slight delay to let animation play
                    openCard(key);
                    errorMsg.style.display = 'none';
                }, 300);
            } else {
                errorMsg.style.display = 'block';
            }
        }

        function openCard(key) {
            const t = teacherData[key];
            if(!t) return;

            const html = `
                <h1 class="teacher-name">${t.name}</h1>
                <p class="teacher-title">${t.title}</p>
                
                <div class="urdu-box">
                    <div class="urdu-text">${t.sher}</div>
                </div>

                <div class="section-header">Qualities</div>
                <ul class="qualities-list">
                    ${t.qualities.map(q => `<li>${q}</li>`).join('')}
                </ul>

                <div class="section-header">Our Appreciation</div>
                <div class="appreciation">${t.appreciation}</div>
            `;

            cardContent.innerHTML = html;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeCard() {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function downloadPDF() {
            playAnimation(btnDownload);
            const element = document.getElementById('card-content');
            const name = element.querySelector('.teacher-name').innerText.replace(/\s+/g, '_');
            
            // PDF Configuration for "Proper Card"
            const opt = {
                margin:       0.5, // Margin around the card on the PDF page
                filename:     `Tribute_${name}.pdf`,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { 
                    scale: 3, // Very High Resolution
                    useCORS: true, 
                    backgroundColor: '#fffdf7', // Force the antique white background
                    logging: false
                },
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
            };

            // Generate PDF
            html2pdf().set(opt).from(element).save();
        }

        // Aliases
        teacherData['alina'] = teacherData['anila'];

        // Key Listeners
        input.addEventListener('keypress', (e) => {
            if(e.key === 'Enter') findTribute();
        });

        document.addEventListener('keydown', (e) => {
            if(e.key === 'Escape') closeCard();
        });

    </script>
</body>
</html>